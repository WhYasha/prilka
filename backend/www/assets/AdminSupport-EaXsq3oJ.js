import{m as C,o as h}from"./runtime-dom.esm-bundler-BK6IBOWL.js";import{d as D,e as M,f as _,s as I}from"./admin-DURzgcgM.js";import{H as w,at as N,aB as s,r as a,s as t,bp as v,F as g,aL as y,a$ as n,ak as S,y as x,aJ as r}from"./runtime-core.esm-bundler-DriOm3-t.js";import"./index-DKTJyLdB.js";import"./index-dWvJ5vCQ.js";import"./pinia-CHGKEwD6.js";const T={class:"admin-support-form"},U=["value"],V={key:0,class:"admin-table-wrap"},B={class:"admin-table"},L={key:1},F={key:2,class:"admin-table-wrap"},z={class:"admin-table"},A={class:"msg-content"},E={key:3},q=w({__name:"AdminSupport",setup(H){const b=r([]),p=r([]),m=r([]),i=r(""),d=r(""),u=r("");async function f(){const[o,e,l]=await Promise.all([D(),M(),_()]);b.value=o.users||[],p.value=e.chats||[],m.value=l.messages||[]}async function c(){if(!u.value.trim())return;const o={content:u.value.trim()};if(i.value)o.target_user_id=parseInt(i.value);else if(d.value.trim())o.chat_id=parseInt(d.value.trim());else{alert("Select a target user or enter a chat ID.");return}await I(o),u.value="",alert("Support message sent."),await f()}function k(o){if(!o)return"-";const e=new Date(o);return isNaN(e.getTime())?o:e.toLocaleString()}return N(f),(o,e)=>(s(),a("div",null,[e[11]||(e[11]=t("h1",{class:"admin-page-title"},"Support",-1)),t("div",T,[e[4]||(e[4]=t("h2",null,"Send Support Message",-1)),e[5]||(e[5]=t("label",null,"Target User",-1)),v(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>i.value=l)},[e[3]||(e[3]=t("option",{value:""},"-- Select user --",-1)),(s(!0),a(g,null,y(b.value,l=>(s(),a("option",{key:l.id,value:l.id},n(l.username)+" ("+n(l.display_name)+") ",9,U))),128))],512),[[C,i.value]]),e[6]||(e[6]=t("label",null,"Or Chat ID (direct)",-1)),v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>d.value=l),type:"text",placeholder:"Chat ID"},null,512),[[h,d.value]]),e[7]||(e[7]=t("label",null,"Message",-1)),v(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=l=>u.value=l),placeholder:"Type support message..."},null,512),[[h,u.value]]),e[8]||(e[8]=t("br",null,null,-1)),t("button",{class:"btn btn-primary",onClick:c},"Send as bh_support")]),e[12]||(e[12]=t("h3",{class:"section-title"},"Support Chats",-1)),p.value.length?(s(),a("div",V,[t("table",B,[e[9]||(e[9]=t("thead",null,[t("tr",null,[t("th",null,"Chat ID"),t("th",null,"Type"),t("th",null,"Name"),t("th",null,"Members")])],-1)),t("tbody",null,[(s(!0),a(g,null,y(p.value,l=>(s(),a("tr",{key:l.id},[t("td",null,n(l.id),1),t("td",null,[t("span",{class:S(["badge","badge-"+l.type])},n(l.type),3)]),t("td",null,n(l.name||l.title||"-"),1),t("td",null,n(l.member_count),1)]))),128))])])])):(s(),a("p",L,"No support chats yet.")),e[13]||(e[13]=t("h3",{class:"section-title"},"Recent Support Messages",-1)),m.value.length?(s(),a("div",F,[t("table",z,[e[10]||(e[10]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Chat"),t("th",null,"Content"),t("th",null,"Sent")])],-1)),t("tbody",null,[(s(!0),a(g,null,y(m.value,l=>(s(),a("tr",{key:l.id},[t("td",null,n(l.id),1),t("td",null,[x(n(l.chat_name||l.chat_id)+" ",1),t("span",{class:S(["badge","badge-"+l.chat_type])},n(l.chat_type),3)]),t("td",A,n(l.content),1),t("td",null,n(k(l.created_at)),1)]))),128))])])])):(s(),a("p",E,"No support messages yet."))]))}});export{q as default};
