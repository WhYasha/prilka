import{d as N,G as V,c as l,a as t,f as y,v as m,H as F,F as g,A as b,w as k,e as d,t as o,r as i,o as n,g as x,n as I,h as S,i as T,j as U}from"./index-C4nA6ctO.js";import{c as $}from"./admin-CZJ0Sjsb.js";const B={class:"admin-filter-bar"},L={key:0},A={class:"admin-table-wrap"},K={class:"admin-table"},P={class:"msg-content"},j={key:0,class:"admin-pagination"},q={key:0,class:"current"},z=["onClick"],E={class:"admin-pagination info"},Q=N({__name:"AdminMessages",setup(G){const u=i(null),f=i(!0),p=i(""),v=i(""),c=i(""),s=i(1);async function _(){f.value=!0;try{u.value=await $({page:s.value,per_page:50,user_id:p.value||void 0,chat_id:v.value||void 0,q:c.value||void 0})}finally{f.value=!1}}function C(){s.value=1,_()}function w(){p.value="",v.value="",c.value="",s.value=1,_()}function h(r){s.value=r,_()}function D(r){if(!r)return"-";const a=new Date(r);return isNaN(a.getTime())?r:a.toLocaleString()}return V(_),(r,a)=>{const M=U("router-link");return n(),l("div",null,[a[6]||(a[6]=t("h1",{class:"admin-page-title"},"Messages",-1)),t("div",B,[y(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),type:"text",placeholder:"User ID",style:{width:"100px"}},null,512),[[m,p.value]]),y(t("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>v.value=e),type:"text",placeholder:"Chat ID",style:{width:"100px"}},null,512),[[m,v.value]]),y(t("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>c.value=e),type:"text",placeholder:"Search text",onKeydown:F(C,["enter"])},null,544),[[m,c.value]]),t("button",{class:"btn btn-primary",onClick:C},"Filter"),t("button",{class:"btn btn-muted",onClick:w},"Clear")]),f.value?(n(),l("p",L,"Loading...")):u.value?(n(),l(g,{key:1},[t("div",A,[t("table",K,[a[5]||(a[5]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Chat"),t("th",null,"Sender"),t("th",null,"Type"),t("th",null,"Content"),t("th",null,"Sent")])],-1)),t("tbody",null,[(n(!0),l(g,null,b(u.value.messages,e=>(n(),l("tr",{key:e.id},[t("td",null,o(e.id),1),t("td",null,[x(o(e.chat_name||e.chat_id)+" ",1),t("span",{class:I(["badge","badge-"+e.chat_type])},o(e.chat_type),3)]),t("td",null,[S(M,{to:`/admin/users/${e.sender_id}`},{default:T(()=>[x(o(e.sender_username),1)]),_:2},1032,["to"])]),t("td",null,o(e.message_type),1),t("td",P,o(e.content),1),t("td",null,o(D(e.created_at)),1)]))),128))])])]),u.value.total_pages>1?(n(),l("div",j,[s.value>1?(n(),l("a",{key:0,href:"#",onClick:a[3]||(a[3]=k(e=>h(s.value-1),["prevent"]))},"« Prev")):d("",!0),(n(!0),l(g,null,b(u.value.total_pages,e=>(n(),l(g,{key:e},[e===s.value?(n(),l("span",q,o(e),1)):Math.abs(e-s.value)<3||e===1||e===u.value.total_pages?(n(),l("a",{key:1,href:"#",onClick:k(H=>h(e),["prevent"])},o(e),9,z)):d("",!0)],64))),128)),s.value<u.value.total_pages?(n(),l("a",{key:1,href:"#",onClick:a[4]||(a[4]=k(e=>h(s.value+1),["prevent"]))},"Next »")):d("",!0)])):d("",!0),t("span",E,o(u.value.total)+" total messages",1)],64)):d("",!0)])}}});export{Q as default};
