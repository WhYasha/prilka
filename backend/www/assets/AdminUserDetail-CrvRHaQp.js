import{d as D,G as S,c as a,F as b,a as e,t as s,e as v,h as M,i as U,f as N,v as T,A as k,U as x,r as g,j as B,S as I,J as V,o as u,g as _,n as c}from"./index-C-enQaxn.js";import{b as $,u as L,s as R}from"./admin-Bnl7TChP.js";const j={key:0},E={class:"admin-page-title"},F={class:"admin-detail-card"},J={class:"detail-grid"},z={key:0,class:"badge badge-blocked"},G={key:1,class:"badge badge-inactive"},P={key:2,class:"badge badge-active"},q={key:3,class:"badge badge-admin"},H={class:"admin-actions"},K={class:"admin-support-form"},O={class:"section-title"},Q={key:0,class:"admin-table-wrap"},W={class:"admin-table"},X={class:"section-title"},Y={key:1,class:"admin-table-wrap"},Z={class:"admin-table"},ee={class:"msg-content"},te={key:2},ae=D({__name:"AdminUserDetail",setup(se){const{showConfirm:C}=I(),{showToast:h}=V(),w=x(),l=g(null),m=g(!0),o=g(""),p=parseInt(w.params.id);async function y(){m.value=!0;try{l.value=await $(p)}finally{m.value=!1}}async function i(d){const t=d==="soft-delete"?"Are you sure you want to soft-delete this user?":`Are you sure you want to ${d} this user?`;await C({title:d.charAt(0).toUpperCase()+d.slice(1).replace("-"," "),message:t,confirmLabel:d==="soft-delete"?"Delete":d.charAt(0).toUpperCase()+d.slice(1),danger:d==="block"||d==="soft-delete"})&&(await L(p,d),await y())}async function A(){o.value.trim()&&(await R({target_user_id:p,content:o.value.trim()}),o.value="",h("Support message sent."))}function r(d){if(!d)return"-";const t=new Date(d);return isNaN(t.getTime())?d:t.toLocaleString()}return S(y),(d,t)=>{const f=B("router-link");return u(),a("div",null,[m.value?(u(),a("p",j,"Loading...")):l.value?.user?(u(),a(b,{key:1},[e("h1",E," User #"+s(l.value.user.id)+" - "+s(l.value.user.username),1),e("div",F,[t[15]||(t[15]=e("h2",null,"Profile",-1)),e("dl",J,[t[5]||(t[5]=e("dt",null,"ID",-1)),e("dd",null,s(l.value.user.id),1),t[6]||(t[6]=e("dt",null,"Username",-1)),e("dd",null,s(l.value.user.username),1),t[7]||(t[7]=e("dt",null,"Display Name",-1)),e("dd",null,s(l.value.user.display_name),1),t[8]||(t[8]=e("dt",null,"Email",-1)),e("dd",null,s(l.value.user.email),1),t[9]||(t[9]=e("dt",null,"Bio",-1)),e("dd",null,s(l.value.user.bio||"-"),1),t[10]||(t[10]=e("dt",null,"Status",-1)),e("dd",null,[l.value.user.is_blocked?(u(),a("span",z,"Blocked")):l.value.user.is_active?(u(),a("span",P,"Active")):(u(),a("span",G,"Inactive")),l.value.user.is_admin?(u(),a("span",q,"Admin")):v("",!0)]),t[11]||(t[11]=e("dt",null,"Created",-1)),e("dd",null,s(r(l.value.user.created_at)),1),t[12]||(t[12]=e("dt",null,"Updated",-1)),e("dd",null,s(r(l.value.user.updated_at)),1),t[13]||(t[13]=e("dt",null,"Last Active",-1)),e("dd",null,s(r(l.value.user.last_activity)),1),t[14]||(t[14]=e("dt",null,"Messages",-1)),e("dd",null,s(l.value.message_count),1)])]),e("div",H,[l.value.user.is_blocked?(u(),a("button",{key:0,class:"btn btn-success btn-sm",onClick:t[0]||(t[0]=n=>i("unblock"))},"Unblock")):(u(),a("button",{key:1,class:"btn btn-danger btn-sm",onClick:t[1]||(t[1]=n=>i("block"))},"Block")),e("button",{class:"btn btn-danger btn-sm",onClick:t[2]||(t[2]=n=>i("soft-delete"))},"Soft Delete"),e("button",{class:"btn btn-warning btn-sm",onClick:t[3]||(t[3]=n=>i("toggle-admin"))},s(l.value.user.is_admin?"Remove Admin":"Make Admin"),1),M(f,{class:"btn btn-primary btn-sm",to:`/admin/messages?user_id=${l.value.user.id}`},{default:U(()=>[...t[16]||(t[16]=[_(" View Messages ",-1)])]),_:1},8,["to"])]),e("div",K,[t[17]||(t[17]=e("h2",null,"Send Support Message",-1)),t[18]||(t[18]=e("label",null,"Message",-1)),N(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=n=>o.value=n),placeholder:"Type support message..."},null,512),[[T,o.value]]),t[19]||(t[19]=e("br",null,null,-1)),e("button",{class:"btn btn-primary",onClick:A},"Send as bh_support")]),e("h3",O,"Chats ("+s(l.value.chats?.length||0)+")",1),l.value.chats?.length?(u(),a("div",Q,[e("table",W,[t[20]||(t[20]=e("thead",null,[e("tr",null,[e("th",null,"Chat ID"),e("th",null,"Type"),e("th",null,"Name"),e("th",null,"Role"),e("th",null,"Members"),e("th",null,"Joined")])],-1)),e("tbody",null,[(u(!0),a(b,null,k(l.value.chats,n=>(u(),a("tr",{key:n.id},[e("td",null,s(n.id),1),e("td",null,[e("span",{class:c(["badge","badge-"+n.type])},s(n.type),3)]),e("td",null,s(n.name||n.title||"-"),1),e("td",null,s(n.role),1),e("td",null,s(n.member_count),1),e("td",null,s(r(n.joined_at)),1)]))),128))])])])):v("",!0),e("h3",X,"Recent Messages ("+s(l.value.messages?.length||0)+")",1),l.value.messages?.length?(u(),a("div",Y,[e("table",Z,[t[21]||(t[21]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"Chat"),e("th",null,"Type"),e("th",null,"Content"),e("th",null,"Sent")])],-1)),e("tbody",null,[(u(!0),a(b,null,k(l.value.messages,n=>(u(),a("tr",{key:n.id},[e("td",null,s(n.id),1),e("td",null,[_(s(n.chat_name||n.chat_id)+" ",1),e("span",{class:c(["badge","badge-"+n.chat_type])},s(n.chat_type),3)]),e("td",null,s(n.message_type),1),e("td",ee,s(n.content),1),e("td",null,s(r(n.created_at)),1)]))),128))])])])):v("",!0)],64)):(u(),a("p",te,"User not found."))])}}});export{ae as default};
