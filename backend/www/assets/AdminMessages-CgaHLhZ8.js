import{o as f,w as M,s as h}from"./runtime-dom.esm-bundler-BK6IBOWL.js";import{c as V}from"./admin-BLvPyki-.js";import{H as F,at as I,aN as S,aB as l,r as n,s as t,bp as k,F as m,aL as C,a$ as o,y as x,ak as T,z as U,bn as $,q as d,aJ as i}from"./runtime-core.esm-bundler-DriOm3-t.js";import"./index-BLOxppfk.js";import"./index-Cmf1cu1q.js";import"./pinia-CHGKEwD6.js";const B={class:"admin-filter-bar"},L={key:0},q={class:"admin-table-wrap"},z={class:"admin-table"},K={class:"msg-content"},P={key:0,class:"admin-pagination"},A={key:0,class:"current"},E=["onClick"],H={class:"admin-pagination info"},Y=F({__name:"AdminMessages",setup(J){const r=i(null),g=i(!0),p=i(""),v=i(""),c=i(""),s=i(1);async function _(){g.value=!0;try{r.value=await V({page:s.value,per_page:50,user_id:p.value||void 0,chat_id:v.value||void 0,q:c.value||void 0})}finally{g.value=!1}}function b(){s.value=1,_()}function w(){p.value="",v.value="",c.value="",s.value=1,_()}function y(u){s.value=u,_()}function N(u){if(!u)return"-";const a=new Date(u);return isNaN(a.getTime())?u:a.toLocaleString()}return I(_),(u,a)=>{const D=S("router-link");return l(),n("div",null,[a[6]||(a[6]=t("h1",{class:"admin-page-title"},"Messages",-1)),t("div",B,[k(t("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),type:"text",placeholder:"User ID",style:{width:"100px"}},null,512),[[f,p.value]]),k(t("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>v.value=e),type:"text",placeholder:"Chat ID",style:{width:"100px"}},null,512),[[f,v.value]]),k(t("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>c.value=e),type:"text",placeholder:"Search text",onKeydown:M(b,["enter"])},null,544),[[f,c.value]]),t("button",{class:"btn btn-primary",onClick:b},"Filter"),t("button",{class:"btn btn-muted",onClick:w},"Clear")]),g.value?(l(),n("p",L,"Loading...")):r.value?(l(),n(m,{key:1},[t("div",q,[t("table",z,[a[5]||(a[5]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Chat"),t("th",null,"Sender"),t("th",null,"Type"),t("th",null,"Content"),t("th",null,"Sent")])],-1)),t("tbody",null,[(l(!0),n(m,null,C(r.value.messages,e=>(l(),n("tr",{key:e.id},[t("td",null,o(e.id),1),t("td",null,[x(o(e.chat_name||e.chat_id)+" ",1),t("span",{class:T(["badge","badge-"+e.chat_type])},o(e.chat_type),3)]),t("td",null,[U(D,{to:`/admin/users/${e.sender_id}`},{default:$(()=>[x(o(e.sender_username),1)]),_:2},1032,["to"])]),t("td",null,o(e.message_type),1),t("td",K,o(e.content),1),t("td",null,o(N(e.created_at)),1)]))),128))])])]),r.value.total_pages>1?(l(),n("div",P,[s.value>1?(l(),n("a",{key:0,href:"#",onClick:a[3]||(a[3]=h(e=>y(s.value-1),["prevent"]))},"« Prev")):d("",!0),(l(!0),n(m,null,C(r.value.total_pages,e=>(l(),n(m,{key:e},[e===s.value?(l(),n("span",A,o(e),1)):Math.abs(e-s.value)<3||e===1||e===r.value.total_pages?(l(),n("a",{key:1,href:"#",onClick:h(j=>y(e),["prevent"])},o(e),9,E)):d("",!0)],64))),128)),s.value<r.value.total_pages?(l(),n("a",{key:1,href:"#",onClick:a[4]||(a[4]=h(e=>y(s.value+1),["prevent"]))},"Next »")):d("",!0)])):d("",!0),t("span",H,o(r.value.total)+" total messages",1)],64)):d("",!0)])}}});export{Y as default};
