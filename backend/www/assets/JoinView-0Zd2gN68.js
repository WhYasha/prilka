import{d as x,E as w,c as s,a,F as f,t as o,g as p,h as y,b as m,R as C,r as l,i as j,j as I,I as N,o as n,f as g}from"./index-CEBuEbNQ.js";import{p as T,_ as J,j as V}from"./invites-SvOVhVrG.js";const F={class:"auth-page"},R={class:"auth-card",style:{"text-align":"center"}},z={key:0},B={class:"auth-title"},M={class:"auth-subtitle"},E={class:"profile-avatar-section"},L={style:{"font-size":"1.25rem","font-weight":"700","margin-top":".5rem"}},D={key:0,style:{color:"var(--text-muted)","margin-top":".5rem","line-height":"1.5"}},G={key:1,style:{color:"var(--text-muted)","font-size":".85rem","margin-top":".25rem"}},S={style:{"margin-top":"1.25rem",display:"flex",gap:".75rem","justify-content":"center"}},Y=["disabled"],H=x({__name:"JoinView",setup($){const _=C(),k=I(),{showToast:h}=N(),t=l(null),v=l(!0),u=l(!1),c=l(""),i=l("");w(async()=>{const r=_.params.token;if(!r){c.value="Invalid Link",i.value="No invite token provided.",v.value=!1;return}try{t.value=await T(r)}catch(e){e.response?.status===410?(c.value="Invite Revoked",i.value="This invite link has been revoked."):(c.value="Invite Not Found",i.value="This invite link is invalid or has expired.")}finally{v.value=!1}});async function b(){const r=_.params.token;u.value=!0;try{const e=await V(r);h(e.already_member?"You are already a member":"Joined successfully!"),k.push("/app")}catch(e){h(e.response?.data?.error||"Failed to join")}finally{u.value=!1}}return(r,e)=>{const d=j("router-link");return n(),s("div",F,[a("div",R,[v.value?(n(),s("p",z,"Loading invite preview...")):i.value?(n(),s(f,{key:1},[a("h2",B,o(c.value),1),a("p",M,o(i.value),1),p(d,{to:"/app",class:"btn btn-primary",style:{"margin-top":"1rem"}},{default:y(()=>[...e[0]||(e[0]=[g(" Go to Messenger ",-1)])]),_:1})],64)):t.value?(n(),s(f,{key:2},[a("div",E,[p(J,{name:t.value.title||"Chat",size:"xl"},null,8,["name"])]),a("h2",L,o(t.value.title||t.value.type||"Chat"),1),t.value.description?(n(),s("p",D,o(t.value.description),1)):m("",!0),t.value.member_count?(n(),s("p",G,o(t.value.member_count)+" members ",1)):m("",!0),a("div",S,[a("button",{class:"btn btn-primary",disabled:u.value,onClick:b},o(u.value?"Joining...":"Join"),9,Y),p(d,{to:"/app",class:"btn btn-ghost"},{default:y(()=>[...e[1]||(e[1]=[g("Cancel",-1)])]),_:1})])],64)):m("",!0)])])}}});export{H as default};
