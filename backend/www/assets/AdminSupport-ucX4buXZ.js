import{d as D,G as M,c as s,a as t,f as v,R as _,F as g,A as y,v as S,r as u,J as w,o as a,t as n,n as c,g as I}from"./index-DhCiW-Og.js";import{d as T,e as N,f as x,s as U}from"./admin-BpYKdVYM.js";const V={class:"admin-support-form"},B=["value"],A={key:0,class:"admin-table-wrap"},F={class:"admin-table"},L={key:1},R={key:2,class:"admin-table-wrap"},z={class:"admin-table"},E={class:"msg-content"},G={key:3},j=D({__name:"AdminSupport",setup(J){const{showToast:b}=w(),h=u([]),p=u([]),m=u([]),d=u(""),i=u(""),r=u("");async function f(){const[o,e,l]=await Promise.all([T(),N(),x()]);h.value=o.users||[],p.value=e.chats||[],m.value=l.messages||[]}async function C(){if(!r.value.trim())return;const o={content:r.value.trim()};if(d.value)o.target_user_id=parseInt(d.value);else if(i.value.trim())o.chat_id=parseInt(i.value.trim());else{b("Select a target user or enter a chat ID.");return}await U(o),r.value="",b("Support message sent."),await f()}function k(o){if(!o)return"-";const e=new Date(o);return isNaN(e.getTime())?o:e.toLocaleString()}return M(f),(o,e)=>(a(),s("div",null,[e[11]||(e[11]=t("h1",{class:"admin-page-title"},"Support",-1)),t("div",V,[e[4]||(e[4]=t("h2",null,"Send Support Message",-1)),e[5]||(e[5]=t("label",null,"Target User",-1)),v(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>d.value=l)},[e[3]||(e[3]=t("option",{value:""},"-- Select user --",-1)),(a(!0),s(g,null,y(h.value,l=>(a(),s("option",{key:l.id,value:l.id},n(l.username)+" ("+n(l.display_name)+") ",9,B))),128))],512),[[_,d.value]]),e[6]||(e[6]=t("label",null,"Or Chat ID (direct)",-1)),v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>i.value=l),type:"text",placeholder:"Chat ID"},null,512),[[S,i.value]]),e[7]||(e[7]=t("label",null,"Message",-1)),v(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=l=>r.value=l),placeholder:"Type support message..."},null,512),[[S,r.value]]),e[8]||(e[8]=t("br",null,null,-1)),t("button",{class:"btn btn-primary",onClick:C},"Send as bh_support")]),e[12]||(e[12]=t("h3",{class:"section-title"},"Support Chats",-1)),p.value.length?(a(),s("div",A,[t("table",F,[e[9]||(e[9]=t("thead",null,[t("tr",null,[t("th",null,"Chat ID"),t("th",null,"Type"),t("th",null,"Name"),t("th",null,"Members")])],-1)),t("tbody",null,[(a(!0),s(g,null,y(p.value,l=>(a(),s("tr",{key:l.id},[t("td",null,n(l.id),1),t("td",null,[t("span",{class:c(["badge","badge-"+l.type])},n(l.type),3)]),t("td",null,n(l.name||l.title||"-"),1),t("td",null,n(l.member_count),1)]))),128))])])])):(a(),s("p",L,"No support chats yet.")),e[13]||(e[13]=t("h3",{class:"section-title"},"Recent Support Messages",-1)),m.value.length?(a(),s("div",R,[t("table",z,[e[10]||(e[10]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Chat"),t("th",null,"Content"),t("th",null,"Sent")])],-1)),t("tbody",null,[(a(!0),s(g,null,y(m.value,l=>(a(),s("tr",{key:l.id},[t("td",null,n(l.id),1),t("td",null,[I(n(l.chat_name||l.chat_id)+" ",1),t("span",{class:c(["badge","badge-"+l.chat_type])},n(l.chat_type),3)]),t("td",E,n(l.content),1),t("td",null,n(k(l.created_at)),1)]))),128))])])])):(a(),s("p",G,"No support messages yet."))]))}});export{j as default};
