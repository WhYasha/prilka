import{d as x,G as w,c as s,a,F as y,t as o,h as p,i as f,e as m,U as C,r as l,j,k as J,J as N,o as n,g as k}from"./index-CdteRl7k.js";import{p as T,_ as I,j as V}from"./invites-Bge7QQZO.js";const F={class:"auth-page"},z={class:"auth-card",style:{"text-align":"center"}},B={key:0},M={class:"auth-title"},R={class:"auth-subtitle"},G={class:"profile-avatar-section"},L={style:{"font-size":"1.25rem","font-weight":"700","margin-top":".5rem"}},D={key:0,style:{color:"var(--text-muted)","margin-top":".5rem","line-height":"1.5"}},E={key:1,style:{color:"var(--text-muted)","font-size":".85rem","margin-top":".25rem"}},S={style:{"margin-top":"1.25rem",display:"flex",gap:".75rem","justify-content":"center"}},U=["disabled"],A=x({__name:"JoinView",setup(Y){const _=C(),g=J(),{showToast:h}=N(),t=l(null),v=l(!0),u=l(!1),c=l(""),i=l("");w(async()=>{const r=_.params.token;if(!r){c.value="Invalid Link",i.value="No invite token provided.",v.value=!1;return}try{t.value=await T(r)}catch(e){e.response?.status===410?(c.value="Invite Revoked",i.value="This invite link has been revoked."):(c.value="Invite Not Found",i.value="This invite link is invalid or has expired.")}finally{v.value=!1}});async function b(){const r=_.params.token;u.value=!0;try{const e=await V(r);h(e.already_member?"You are already a member":"Joined successfully!"),g.push("/app")}catch(e){h(e.response?.data?.error||"Failed to join")}finally{u.value=!1}}return(r,e)=>{const d=j("router-link");return n(),s("div",F,[a("div",z,[v.value?(n(),s("p",B,"Loading invite preview...")):i.value?(n(),s(y,{key:1},[a("h2",M,o(c.value),1),a("p",R,o(i.value),1),p(d,{to:"/app",class:"btn btn-primary",style:{"margin-top":"1rem"}},{default:f(()=>[...e[0]||(e[0]=[k(" Go to Messenger ",-1)])]),_:1})],64)):t.value?(n(),s(y,{key:2},[a("div",G,[p(I,{name:t.value.title||"Chat",size:"xl"},null,8,["name"])]),a("h2",L,o(t.value.title||t.value.type||"Chat"),1),t.value.description?(n(),s("p",D,o(t.value.description),1)):m("",!0),t.value.member_count?(n(),s("p",E,o(t.value.member_count)+" members ",1)):m("",!0),a("div",S,[a("button",{class:"btn btn-primary",disabled:u.value,onClick:b},o(u.value?"Joining...":"Join"),9,U),p(d,{to:"/app",class:"btn btn-ghost"},{default:f(()=>[...e[1]||(e[1]=[k("Cancel",-1)])]),_:1})])],64)):m("",!0)])])}}});export{A as default};
