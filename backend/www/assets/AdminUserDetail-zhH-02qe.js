import{o as w}from"./runtime-dom.esm-bundler-BK6IBOWL.js";import{c as D}from"./index-DKTJyLdB.js";import{b as M,u as S,s as A}from"./admin-DURzgcgM.js";import{H as N,at as U,aN as B,aB as a,r as u,F as b,s as t,a$ as s,q as v,z as $,bn as x,y as k,bp as I,aL as f,ak as _,aJ as g}from"./runtime-core.esm-bundler-DriOm3-t.js";import"./index-dWvJ5vCQ.js";import"./pinia-CHGKEwD6.js";const T={key:0},V={class:"admin-page-title"},L={class:"admin-detail-card"},R={class:"detail-grid"},z={key:0,class:"badge badge-blocked"},E={key:1,class:"badge badge-inactive"},F={key:2,class:"badge badge-active"},J={key:3,class:"badge badge-admin"},j={class:"admin-actions"},q={class:"admin-support-form"},H={class:"section-title"},P={key:0,class:"admin-table-wrap"},G={class:"admin-table"},K={class:"section-title"},O={key:1,class:"admin-table-wrap"},Q={class:"admin-table"},W={class:"msg-content"},X={key:2},at=N({__name:"AdminUserDetail",setup(Y){const c=D(),l=g(null),m=g(!0),o=g(""),p=parseInt(c.params.id);async function y(){m.value=!0;try{l.value=await M(p)}finally{m.value=!1}}async function r(d){const e=d==="soft-delete"?"Are you sure you want to soft-delete this user?":`Are you sure you want to ${d} this user?`;confirm(e)&&(await S(p,d),await y())}async function C(){o.value.trim()&&(await A({target_user_id:p,content:o.value.trim()}),o.value="",alert("Support message sent."))}function i(d){if(!d)return"-";const e=new Date(d);return isNaN(e.getTime())?d:e.toLocaleString()}return U(y),(d,e)=>{const h=B("router-link");return a(),u("div",null,[m.value?(a(),u("p",T,"Loading...")):l.value?.user?(a(),u(b,{key:1},[t("h1",V," User #"+s(l.value.user.id)+" - "+s(l.value.user.username),1),t("div",L,[e[15]||(e[15]=t("h2",null,"Profile",-1)),t("dl",R,[e[5]||(e[5]=t("dt",null,"ID",-1)),t("dd",null,s(l.value.user.id),1),e[6]||(e[6]=t("dt",null,"Username",-1)),t("dd",null,s(l.value.user.username),1),e[7]||(e[7]=t("dt",null,"Display Name",-1)),t("dd",null,s(l.value.user.display_name),1),e[8]||(e[8]=t("dt",null,"Email",-1)),t("dd",null,s(l.value.user.email),1),e[9]||(e[9]=t("dt",null,"Bio",-1)),t("dd",null,s(l.value.user.bio||"-"),1),e[10]||(e[10]=t("dt",null,"Status",-1)),t("dd",null,[l.value.user.is_blocked?(a(),u("span",z,"Blocked")):l.value.user.is_active?(a(),u("span",F,"Active")):(a(),u("span",E,"Inactive")),l.value.user.is_admin?(a(),u("span",J,"Admin")):v("",!0)]),e[11]||(e[11]=t("dt",null,"Created",-1)),t("dd",null,s(i(l.value.user.created_at)),1),e[12]||(e[12]=t("dt",null,"Updated",-1)),t("dd",null,s(i(l.value.user.updated_at)),1),e[13]||(e[13]=t("dt",null,"Last Active",-1)),t("dd",null,s(i(l.value.user.last_activity)),1),e[14]||(e[14]=t("dt",null,"Messages",-1)),t("dd",null,s(l.value.message_count),1)])]),t("div",j,[l.value.user.is_blocked?(a(),u("button",{key:0,class:"btn btn-success btn-sm",onClick:e[0]||(e[0]=n=>r("unblock"))},"Unblock")):(a(),u("button",{key:1,class:"btn btn-danger btn-sm",onClick:e[1]||(e[1]=n=>r("block"))},"Block")),t("button",{class:"btn btn-danger btn-sm",onClick:e[2]||(e[2]=n=>r("soft-delete"))},"Soft Delete"),t("button",{class:"btn btn-warning btn-sm",onClick:e[3]||(e[3]=n=>r("toggle-admin"))},s(l.value.user.is_admin?"Remove Admin":"Make Admin"),1),$(h,{class:"btn btn-primary btn-sm",to:`/admin/messages?user_id=${l.value.user.id}`},{default:x(()=>[...e[16]||(e[16]=[k(" View Messages ",-1)])]),_:1},8,["to"])]),t("div",q,[e[17]||(e[17]=t("h2",null,"Send Support Message",-1)),e[18]||(e[18]=t("label",null,"Message",-1)),I(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=n=>o.value=n),placeholder:"Type support message..."},null,512),[[w,o.value]]),e[19]||(e[19]=t("br",null,null,-1)),t("button",{class:"btn btn-primary",onClick:C},"Send as bh_support")]),t("h3",H,"Chats ("+s(l.value.chats?.length||0)+")",1),l.value.chats?.length?(a(),u("div",P,[t("table",G,[e[20]||(e[20]=t("thead",null,[t("tr",null,[t("th",null,"Chat ID"),t("th",null,"Type"),t("th",null,"Name"),t("th",null,"Role"),t("th",null,"Members"),t("th",null,"Joined")])],-1)),t("tbody",null,[(a(!0),u(b,null,f(l.value.chats,n=>(a(),u("tr",{key:n.id},[t("td",null,s(n.id),1),t("td",null,[t("span",{class:_(["badge","badge-"+n.type])},s(n.type),3)]),t("td",null,s(n.name||n.title||"-"),1),t("td",null,s(n.role),1),t("td",null,s(n.member_count),1),t("td",null,s(i(n.joined_at)),1)]))),128))])])])):v("",!0),t("h3",K,"Recent Messages ("+s(l.value.messages?.length||0)+")",1),l.value.messages?.length?(a(),u("div",O,[t("table",Q,[e[21]||(e[21]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Chat"),t("th",null,"Type"),t("th",null,"Content"),t("th",null,"Sent")])],-1)),t("tbody",null,[(a(!0),u(b,null,f(l.value.messages,n=>(a(),u("tr",{key:n.id},[t("td",null,s(n.id),1),t("td",null,[k(s(n.chat_name||n.chat_id)+" ",1),t("span",{class:_(["badge","badge-"+n.chat_type])},s(n.chat_type),3)]),t("td",null,s(n.message_type),1),t("td",W,s(n.content),1),t("td",null,s(i(n.created_at)),1)]))),128))])])])):v("",!0)],64)):(a(),u("p",X,"User not found."))])}}});export{at as default};
