import{d as w,A,c as a,F as b,a as t,t as s,b as v,g as D,h as M,e as S,v as N,q as k,L as U,r as g,i as x,o as u,f,p as _}from"./index-F_3jQ4-e.js";import{b as B,u as I,s as T}from"./admin-CcptACUI.js";const V={key:0},$={class:"admin-page-title"},L={class:"admin-detail-card"},R={class:"detail-grid"},E={key:0,class:"badge badge-blocked"},F={key:1,class:"badge badge-inactive"},j={key:2,class:"badge badge-active"},q={key:3,class:"badge badge-admin"},z={class:"admin-actions"},J={class:"admin-support-form"},P={class:"section-title"},G={key:0,class:"admin-table-wrap"},H={class:"admin-table"},K={class:"section-title"},O={key:1,class:"admin-table-wrap"},Q={class:"admin-table"},W={class:"msg-content"},X={key:2},et=w({__name:"AdminUserDetail",setup(Y){const c=U(),l=g(null),m=g(!0),o=g(""),p=parseInt(c.params.id);async function y(){m.value=!0;try{l.value=await B(p)}finally{m.value=!1}}async function r(d){const e=d==="soft-delete"?"Are you sure you want to soft-delete this user?":`Are you sure you want to ${d} this user?`;confirm(e)&&(await I(p,d),await y())}async function C(){o.value.trim()&&(await T({target_user_id:p,content:o.value.trim()}),o.value="",alert("Support message sent."))}function i(d){if(!d)return"-";const e=new Date(d);return isNaN(e.getTime())?d:e.toLocaleString()}return A(y),(d,e)=>{const h=x("router-link");return u(),a("div",null,[m.value?(u(),a("p",V,"Loading...")):l.value?.user?(u(),a(b,{key:1},[t("h1",$," User #"+s(l.value.user.id)+" - "+s(l.value.user.username),1),t("div",L,[e[15]||(e[15]=t("h2",null,"Profile",-1)),t("dl",R,[e[5]||(e[5]=t("dt",null,"ID",-1)),t("dd",null,s(l.value.user.id),1),e[6]||(e[6]=t("dt",null,"Username",-1)),t("dd",null,s(l.value.user.username),1),e[7]||(e[7]=t("dt",null,"Display Name",-1)),t("dd",null,s(l.value.user.display_name),1),e[8]||(e[8]=t("dt",null,"Email",-1)),t("dd",null,s(l.value.user.email),1),e[9]||(e[9]=t("dt",null,"Bio",-1)),t("dd",null,s(l.value.user.bio||"-"),1),e[10]||(e[10]=t("dt",null,"Status",-1)),t("dd",null,[l.value.user.is_blocked?(u(),a("span",E,"Blocked")):l.value.user.is_active?(u(),a("span",j,"Active")):(u(),a("span",F,"Inactive")),l.value.user.is_admin?(u(),a("span",q,"Admin")):v("",!0)]),e[11]||(e[11]=t("dt",null,"Created",-1)),t("dd",null,s(i(l.value.user.created_at)),1),e[12]||(e[12]=t("dt",null,"Updated",-1)),t("dd",null,s(i(l.value.user.updated_at)),1),e[13]||(e[13]=t("dt",null,"Last Active",-1)),t("dd",null,s(i(l.value.user.last_activity)),1),e[14]||(e[14]=t("dt",null,"Messages",-1)),t("dd",null,s(l.value.message_count),1)])]),t("div",z,[l.value.user.is_blocked?(u(),a("button",{key:0,class:"btn btn-success btn-sm",onClick:e[0]||(e[0]=n=>r("unblock"))},"Unblock")):(u(),a("button",{key:1,class:"btn btn-danger btn-sm",onClick:e[1]||(e[1]=n=>r("block"))},"Block")),t("button",{class:"btn btn-danger btn-sm",onClick:e[2]||(e[2]=n=>r("soft-delete"))},"Soft Delete"),t("button",{class:"btn btn-warning btn-sm",onClick:e[3]||(e[3]=n=>r("toggle-admin"))},s(l.value.user.is_admin?"Remove Admin":"Make Admin"),1),D(h,{class:"btn btn-primary btn-sm",to:`/admin/messages?user_id=${l.value.user.id}`},{default:M(()=>[...e[16]||(e[16]=[f(" View Messages ",-1)])]),_:1},8,["to"])]),t("div",J,[e[17]||(e[17]=t("h2",null,"Send Support Message",-1)),e[18]||(e[18]=t("label",null,"Message",-1)),S(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=n=>o.value=n),placeholder:"Type support message..."},null,512),[[N,o.value]]),e[19]||(e[19]=t("br",null,null,-1)),t("button",{class:"btn btn-primary",onClick:C},"Send as bh_support")]),t("h3",P,"Chats ("+s(l.value.chats?.length||0)+")",1),l.value.chats?.length?(u(),a("div",G,[t("table",H,[e[20]||(e[20]=t("thead",null,[t("tr",null,[t("th",null,"Chat ID"),t("th",null,"Type"),t("th",null,"Name"),t("th",null,"Role"),t("th",null,"Members"),t("th",null,"Joined")])],-1)),t("tbody",null,[(u(!0),a(b,null,k(l.value.chats,n=>(u(),a("tr",{key:n.id},[t("td",null,s(n.id),1),t("td",null,[t("span",{class:_(["badge","badge-"+n.type])},s(n.type),3)]),t("td",null,s(n.name||n.title||"-"),1),t("td",null,s(n.role),1),t("td",null,s(n.member_count),1),t("td",null,s(i(n.joined_at)),1)]))),128))])])])):v("",!0),t("h3",K,"Recent Messages ("+s(l.value.messages?.length||0)+")",1),l.value.messages?.length?(u(),a("div",O,[t("table",Q,[e[21]||(e[21]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Chat"),t("th",null,"Type"),t("th",null,"Content"),t("th",null,"Sent")])],-1)),t("tbody",null,[(u(!0),a(b,null,k(l.value.messages,n=>(u(),a("tr",{key:n.id},[t("td",null,s(n.id),1),t("td",null,[f(s(n.chat_name||n.chat_id)+" ",1),t("span",{class:_(["badge","badge-"+n.chat_type])},s(n.chat_type),3)]),t("td",null,s(n.message_type),1),t("td",W,s(n.content),1),t("td",null,s(i(n.created_at)),1)]))),128))])])])):v("",!0)],64)):(u(),a("p",X,"User not found."))])}}});export{et as default};
