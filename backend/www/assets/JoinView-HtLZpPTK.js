import{c as x,u as w}from"./index-BLOxppfk.js";import{p as C,_ as N,j as J}from"./invites-CEBEyD-c.js";import{u as T}from"./useToast-DSjNtmSI.js";import{H as j,at as I,aN as V,aB as s,r as o,s as a,F as f,a$ as n,z as p,bn as y,y as k,q as v,aJ as l}from"./runtime-core.esm-bundler-DriOm3-t.js";import"./index-Cmf1cu1q.js";import"./pinia-CHGKEwD6.js";const z={class:"auth-page"},B={class:"auth-card",style:{"text-align":"center"}},F={key:0},M={class:"auth-title"},R={class:"auth-subtitle"},L={class:"profile-avatar-section"},$={style:{"font-size":"1.25rem","font-weight":"700","margin-top":".5rem"}},q={key:0,style:{color:"var(--text-muted)","margin-top":".5rem","line-height":"1.5"}},D={key:1,style:{color:"var(--text-muted)","font-size":".85rem","margin-top":".25rem"}},E={style:{"margin-top":"1.25rem",display:"flex",gap:".75rem","justify-content":"center"}},G=["disabled"],Q=j({__name:"JoinView",setup(H){const _=x(),g=w(),{showToast:h}=T(),t=l(null),d=l(!0),u=l(!1),c=l(""),r=l("");I(async()=>{const i=_.params.token;if(!i){c.value="Invalid Link",r.value="No invite token provided.",d.value=!1;return}try{t.value=await C(i)}catch(e){e.response?.status===410?(c.value="Invite Revoked",r.value="This invite link has been revoked."):(c.value="Invite Not Found",r.value="This invite link is invalid or has expired.")}finally{d.value=!1}});async function b(){const i=_.params.token;u.value=!0;try{const e=await J(i);h(e.already_member?"You are already a member":"Joined successfully!"),g.push("/app")}catch(e){h(e.response?.data?.error||"Failed to join")}finally{u.value=!1}}return(i,e)=>{const m=V("router-link");return s(),o("div",z,[a("div",B,[d.value?(s(),o("p",F,"Loading invite preview...")):r.value?(s(),o(f,{key:1},[a("h2",M,n(c.value),1),a("p",R,n(r.value),1),p(m,{to:"/app",class:"btn btn-primary",style:{"margin-top":"1rem"}},{default:y(()=>[...e[0]||(e[0]=[k(" Go to Messenger ",-1)])]),_:1})],64)):t.value?(s(),o(f,{key:2},[a("div",L,[p(N,{name:t.value.title||"Chat",size:"xl"},null,8,["name"])]),a("h2",$,n(t.value.title||t.value.type||"Chat"),1),t.value.description?(s(),o("p",q,n(t.value.description),1)):v("",!0),t.value.member_count?(s(),o("p",D,n(t.value.member_count)+" members ",1)):v("",!0),a("div",E,[a("button",{class:"btn btn-primary",disabled:u.value,onClick:b},n(u.value?"Joining...":"Join"),9,G),p(m,{to:"/app",class:"btn btn-ghost"},{default:y(()=>[...e[1]||(e[1]=[k("Cancel",-1)])]),_:1})])],64)):v("",!0)])])}}});export{Q as default};
