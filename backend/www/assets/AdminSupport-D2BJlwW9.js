import{d as k,E as D,c as s,a as t,e as v,P as M,F as g,y,v as h,r as o,o as a,t as n,s as S,f as _}from"./index-K3rxxOgd.js";import{d as I,e as w,f as N,s as x}from"./admin-BZWQ6hDO.js";const T={class:"admin-support-form"},U=["value"],V={key:0,class:"admin-table-wrap"},B={class:"admin-table"},E={key:1},F={key:2,class:"admin-table-wrap"},L={class:"admin-table"},P={class:"msg-content"},z={key:3},j=k({__name:"AdminSupport",setup(A){const b=o([]),p=o([]),m=o([]),d=o(""),i=o(""),r=o("");async function f(){const[u,e,l]=await Promise.all([I(),w(),N()]);b.value=u.users||[],p.value=e.chats||[],m.value=l.messages||[]}async function c(){if(!r.value.trim())return;const u={content:r.value.trim()};if(d.value)u.target_user_id=parseInt(d.value);else if(i.value.trim())u.chat_id=parseInt(i.value.trim());else{alert("Select a target user or enter a chat ID.");return}await x(u),r.value="",alert("Support message sent."),await f()}function C(u){if(!u)return"-";const e=new Date(u);return isNaN(e.getTime())?u:e.toLocaleString()}return D(f),(u,e)=>(a(),s("div",null,[e[11]||(e[11]=t("h1",{class:"admin-page-title"},"Support",-1)),t("div",T,[e[4]||(e[4]=t("h2",null,"Send Support Message",-1)),e[5]||(e[5]=t("label",null,"Target User",-1)),v(t("select",{"onUpdate:modelValue":e[0]||(e[0]=l=>d.value=l)},[e[3]||(e[3]=t("option",{value:""},"-- Select user --",-1)),(a(!0),s(g,null,y(b.value,l=>(a(),s("option",{key:l.id,value:l.id},n(l.username)+" ("+n(l.display_name)+") ",9,U))),128))],512),[[M,d.value]]),e[6]||(e[6]=t("label",null,"Or Chat ID (direct)",-1)),v(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>i.value=l),type:"text",placeholder:"Chat ID"},null,512),[[h,i.value]]),e[7]||(e[7]=t("label",null,"Message",-1)),v(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=l=>r.value=l),placeholder:"Type support message..."},null,512),[[h,r.value]]),e[8]||(e[8]=t("br",null,null,-1)),t("button",{class:"btn btn-primary",onClick:c},"Send as bh_support")]),e[12]||(e[12]=t("h3",{class:"section-title"},"Support Chats",-1)),p.value.length?(a(),s("div",V,[t("table",B,[e[9]||(e[9]=t("thead",null,[t("tr",null,[t("th",null,"Chat ID"),t("th",null,"Type"),t("th",null,"Name"),t("th",null,"Members")])],-1)),t("tbody",null,[(a(!0),s(g,null,y(p.value,l=>(a(),s("tr",{key:l.id},[t("td",null,n(l.id),1),t("td",null,[t("span",{class:S(["badge","badge-"+l.type])},n(l.type),3)]),t("td",null,n(l.name||l.title||"-"),1),t("td",null,n(l.member_count),1)]))),128))])])])):(a(),s("p",E,"No support chats yet.")),e[13]||(e[13]=t("h3",{class:"section-title"},"Recent Support Messages",-1)),m.value.length?(a(),s("div",F,[t("table",L,[e[10]||(e[10]=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"Chat"),t("th",null,"Content"),t("th",null,"Sent")])],-1)),t("tbody",null,[(a(!0),s(g,null,y(m.value,l=>(a(),s("tr",{key:l.id},[t("td",null,n(l.id),1),t("td",null,[_(n(l.chat_name||l.chat_id)+" ",1),t("span",{class:S(["badge","badge-"+l.chat_type])},n(l.chat_type),3)]),t("td",P,n(l.content),1),t("td",null,n(C(l.created_at)),1)]))),128))])])])):(a(),s("p",z,"No support messages yet."))]))}});export{j as default};
